<!DOCTYPE html>
<html>
<head>
Â  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
Â  <title>Fuckass Timetable</title>
Â  <style>
Â  Â  /* ** IMPORTANT ** This CSS is optimized for mobile touch screens (Fluid width, large tap targets, no fixed pixels).
Â  Â  */
Â  Â  :root{
Â  Â  Â  --bg: #ffffff;
Â  Â  Â  --card: #f7f7f8;
Â  Â  Â  --muted: #9b9b9b;
Â  Â  Â  --radius: 14px;
Â  Â  Â  --soft-shadow: 0 6px 18px rgba(12,12,14,0.06);
Â  Â  Â  --yellow: #ffd54e;
Â  Â  }
Â  Â  html,body{
Â  Â  Â  height:100%;
Â  Â  Â  margin:0;
Â  Â  Â  font-family:-apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", Arial, sans-serif;
Â  Â  Â  background:var(--bg);
Â  Â  Â  color:#111;Â 
Â  Â  Â  overflow-x: hidden;
Â  Â  }
Â  Â Â 
Â  Â  body {
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: center;Â 
Â  Â  Â  min-height: 100vh;
Â  Â  Â  overflow-y: auto;
Â  Â  Â  padding: 20px 0;Â 
Â  Â  }
Â  Â Â 
Â  Â  .wrap{
Â  Â  Â  max-width:470px;
Â  Â  Â  width: 95%;Â 
Â  Â  Â  padding:16px;
Â  Â  Â  box-sizing: border-box;Â 
Â  Â  }
Â  Â Â 
Â  Â  .title {
Â  Â  Â  font-weight:700;
Â  Â  Â  text-align:center;
Â  Â  Â  font-size:28px;
Â  Â  Â  letter-spacing:-0.6px;
Â  Â  Â  margin-bottom:12px;
Â  Â  Â  position:relative;
Â  Â  }
Â  Â  .tag {
Â  Â  Â  position:absolute;
Â  Â  Â  right:6%;
Â  Â  Â  top:-8px;
Â  Â  Â  transform: rotate(-25deg);
Â  Â  Â  color:#333333 !important;
Â  Â  Â  background:linear-gradient(90deg, rgba(255,236,166,0.95), rgba(255,248,200,0.95));
Â  Â  Â  padding:6px 10px;
Â  Â  Â  border-radius:10px;
Â  Â  Â  box-shadow: var(--soft-shadow);
Â  Â  Â  opacity:0;
Â  Â  Â  animation: tagIn 700ms ease forwards;
Â  Â  Â  font-weight:700;
Â  Â  Â  font-size:12px;
Â  Â  }
Â  Â  @keyframes tagIn{
Â  Â  Â  from { transform: rotate(-45deg) translateY(-10px); opacity:0; }
Â  Â  Â  to { transform: rotate(-25deg) translateY(0); opacity:1; }
Â  Â  }

Â  Â  .card { background:var(--card); border-radius:var(--radius); padding:14px; box-shadow:var(--soft-shadow); margin-bottom:12px; }
Â  Â  label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px;}
Â  Â  select, button, input[type="text"] {
Â  Â  Â  width:100%; padding:12px 14px; border-radius:12px; border:2px solid #111; outline:none; font-size:15px;
Â  Â  Â  background:white; box-sizing:border-box;
Â  Â  Â  min-width: 0;
Â  Â  }
Â  Â  select { border-color:#111; }
Â  Â  .row{
Â  Â  Â  display:flex;
Â  Â  Â  gap:10px;
Â  Â  Â  flex-wrap: wrap;Â 
Â  Â  }
Â  Â  .row > * {Â 
Â  Â  Â  flex:1;Â 
Â  Â  Â  min-width: 100%;Â 
Â  Â  }
Â  Â  .row select {
Â  Â  Â  Â  margin-bottom: 8px;Â 
Â  Â  }
Â  Â  .btn { cursor:pointer; border:none; font-weight:700; background:#111;color:white; border-radius:12px;padding:12px; transition:transform .18s ease; }
Â  Â  .btn:active{ transform:scale(.98); }
Â  Â  .result { padding:12px; margin-top:12px; border-radius:12px; background:linear-gradient(180deg,#fff,#fafafa); border:1px solid #eee; min-height:60px; }
Â  Â  .person { display:flex; gap:10px; align-items:center; padding:8px; border-radius:10px; margin-bottom:8px; }
Â  Â  .swatch{width:14px;height:14px;border-radius:5px;box-shadow:0 2px 6px rgba(0,0,0,0.06);}
Â  Â  .muted{color:var(--muted);font-size:13px}
Â  Â  .extra { margin-top:8px; display:flex; gap:8px; }
Â  Â  .small { padding:8px 10px; font-size:14px; border-radius:10px; background:#fff; border:1px solid #eaeaea; }
Â  Â  .collapse { max-height:0; overflow:hidden; transition:max-height .35s cubic-bezier(.2,.9,.3,1); }
Â  Â  .collapse.open { max-height:420px; }

Â  Â  .person { transform: translateY(6px); opacity:0; animation: personIn .35s forwards; }
Â  Â  .person:nth-child(1){ animation-delay:30ms } .person:nth-child(2){ animation-delay:80ms } .person:nth-child(3){ animation-delay:120ms }Â 
Â  Â  @keyframes personIn { to{ transform:none; opacity:1 } from { transform:translateY(6px); opacity:0 } }

Â  Â  /* Modal Styles (Confirmation & Custom Alert) */
Â  Â  .modalBack{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(10,10,10,0.32); z-index:1000; }
Â  Â  .modal{ width:90%; max-width:420px; background:#fff; border-radius:12px; padding:14px; box-shadow:var(--soft-shadow); }
Â  Â  .tiny{font-size:13px;color:var(--muted); margin-top:8px}
Â  Â Â 
Â  Â  /* Schedule Modal Styles */
Â  Â  .scheduleRow{ display: flex; gap: 8px; margin: 6px 0; align-items: center; }
Â  Â  .scheduleCell{ padding: 8px; border-radius: 8px; border: 1px solid #eee; text-align: left; }
Â  Â  .pnum { width: 50px; text-align: center; font-weight: 600; flex-shrink: 0; background: #f7f7f8; color: #333; border: 1px solid #ddd; }
Â  Â  .subj { flex-grow: 1; }
Â  Â Â 
Â  Â  .scheduleModalBack {
Â  Â  Â  position: fixed;
Â  Â  Â  inset: 0;
Â  Â  Â  background: rgba(10, 10, 10, 0.75);
Â  Â  Â  z-index: 1010;
Â  Â  Â  display: none;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  backdrop-filter: blur(5px);
Â  Â  }
Â  Â  .scheduleModal {
Â  Â  Â  width: 90%;
Â  Â  Â  max-width: 400px;
Â  Â  Â  max-height: 80vh;Â 
Â  Â  Â  background: #fff;
Â  Â  Â  border-radius: 18px;
Â  Â  Â  padding: 20px;
Â  Â  Â  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
Â  Â  Â  overflow-y: auto;Â 
Â  Â  }
Â  Â  .modalHeader {
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  align-items: center;
Â  Â  Â  margin-bottom: 12px;
Â  Â  }
Â  Â  .modalClose {
Â  Â  Â  font-size: 24px;
Â  Â  Â  font-weight: 300;
Â  Â  Â  cursor: pointer;
Â  Â  Â  color: #777;
Â  Â  }
Â  Â Â 
Â  Â  @media (max-width:420px){
Â  Â  Â  .wrap{
Â  Â  Â  Â  padding:12px;
Â  Â  Â  }
Â  Â  Â  .title{font-size:22px}
Â  Â  }
Â  </style>
</head>
<body>
Â  <div class="wrap">
Â  Â  <div class="title card">
Â  Â  Â  <div style="position:relative">
Â  Â  Â  Â  <div style="font-size:28px;">Fuckass Timetable</div>
Â  Â  Â  Â  <div id="randomTag" class="tag" aria-hidden="true"></div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="card">
Â  Â  Â  <label>Week</label>
Â  Â  Â  <select id="weekSelect"></select>

Â  Â  Â  <label style="margin-top:10px">Day</label>
Â  Â  Â  <select id="daySelect"></select>

Â  Â  Â  <label style="margin-top:10px">Period</label>
Â  Â  Â  <select id="periodSelect">
Â  Â  Â  Â  <option value="1">Period 1</option>
Â  Â  Â  Â  <option value="2">Period 2</option>
Â  Â  Â  Â  <option value="3">Period 3</option>
Â  Â  Â  Â  <option value="4">Period 4</option>
Â  Â  Â  Â  <option value="5">Period 5</option>
Â  Â  Â  </select>

Â  Â  Â  <div style="display:flex; gap:10px; margin-top:12px;">
Â  Â  Â  Â  <button class="btn" id="checkBtn">Check who's free</button>
Â  Â  Â  Â  <button class="btn" id="lessonBtn" style="background:#fff;color:#111;border:2px solid #111">Who has a lesson</button>
Â  Â  Â  </div>

Â  Â  Â  <div id="resultArea" class="result"></div>
Â  Â  </div>

Â  Â  <div class="card">
Â  Â  Â  <div style="display:flex; justify-content:space-between; align-items:center;">
Â  Â  Â  Â  <div><strong>Extra features</strong><div class="tiny">Add catchphrase / What do I have today</div></div>
Â  Â  Â  Â  <button id="toggleExtra" class="small">Show</button>
Â  Â  Â  </div>

Â  Â  Â  <div id="extraPanel" class="collapse">
Â  Â  Â  Â  <div style="margin-top:12px;">
Â  Â  Â  Â  Â  <label>Add a catchphrase</label>
Â  Â  Â  Â  Â  <input type="text" id="phraseInput" placeholder="Type phrase...">
Â  Â  Â  Â  Â  <div style="display:flex; gap:8px; margin-top:8px;">
Â  Â  Â  Â  Â  Â  <button id="addPhraseBtn" class="small">Add phrase</button>
Â  Â  Â  Â  Â  Â  <button id="refreshTag" class="small">Refresh random tag</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <hr style="margin:12px 0;border:none;border-top:1px solid #eee">

Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <label>What do I have today?</label>
Â  Â  Â  Â  Â  <div class="row">
Â  Â  Â  Â  Â  Â  <select id="whoSelect"></select>
Â  Â  Â  Â  Â  Â  <select id="weekSelect2"></select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <select id="daySelect2" style="margin-top:8px;width:100%"></select>
Â  Â  Â  Â  Â  <button id="whatBtn" class="btn" style="margin-top:10px">Show my day</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div style="text-align:center; color:var(--muted); font-size:13px; margin-top:8px">Made for iPhone â€” Â© Alessandro 2025</div>
Â  </div>

Â  <!-- Custom Alert/Confirm Modal -->
Â  <div id="confirmModal" style="display:none;"></div>

Â  <!-- Schedule Display Modal -->
Â  <div id="scheduleModalBack" class="scheduleModalBack">
Â  Â  <div id="scheduleModal" class="scheduleModal">
Â  Â  Â  <div class="modalHeader">
Â  Â  Â  Â  <h3 id="scheduleTitle" style="margin:0;">Schedule</h3>
Â  Â  Â  Â  <span id="scheduleClose" class="modalClose">&times;</span>
Â  Â  Â  </div>
Â  Â  Â  <div id="modalScheduleContent">
Â  Â  Â  Â  <!-- Schedule rows will be injected here -->
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

<script>
Â  // ðŸ›‘ðŸ›‘ðŸ›‘ CRITICAL EDIT: PASTE THE WEB APP URL HERE
Â  // Updated with the new deployment ID provided by the user:
Â  const API_ENDPOINT = 'https://script.google.com/macros/s/AKfycbz3Drz1CRWek8MYH5rD1G-kKhdRs28xu4SRJstDkS8JeH-K_0tZlLlq45CSa7mN2yXdQw/exec';Â 
Â Â 
Â  let cfg = null;

Â  /**
Â  Â * Universal function to call the Apps Script API via fetch.
Â  Â */
Â  async function callApi(functionName, args = []) {
Â  Â  // The API URL is set, so we proceed directly to the fetch call.
Â  Â Â 
Â  Â  const payload = { functionName, args };

Â  Â  try {
Â  Â  Â  // Use exponential backoff for retries
Â  Â  Â  let lastError = null;
Â  Â  Â  for (let i = 0; i < 3; i++) {
Â  Â  Â  Â  Â  const response = await fetch(API_ENDPOINT, {
Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(payload)
Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  if (response.ok) {
Â  Â  Â  Â  Â  Â  Â  const result = await response.json();
Â  Â  Â  Â  Â  Â  Â  if (result.success) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  return result.data;
Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(result.error || 'Apps Script execution failed.');
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  // Store the last error and try again
Â  Â  Â  Â  Â  Â  Â  lastError = new Error(`HTTP error! status: ${response.status}`);
Â  Â  Â  Â  Â  Â  Â  if (i < 2) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  // Wait for 2^i seconds before the next retry
Â  Â  Â  Â  Â  Â  Â  Â  Â  await new Promise(resolve => setTimeout(resolve, Math.pow(2, i) * 1000));
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  Â  throw lastError; // Re-throw the last error after retries
Â  Â  } catch (error) {
Â  Â  Â  console.error('API Call Failed:', error);
Â  Â  Â  throw new Error('Connection or script execution error: ' + error.message);
Â  Â  }
Â  }
Â Â 
Â  // --- CORE APP INITIALIZATION ---

Â  async function init() {
Â  Â  try {
Â  Â  Â  const res = await callApi('getConfig');
Â  Â  Â  cfg = res;
Â  Â  Â  populate(res);
Â  Â  Â  loadRandomTag();
Â  Â  } catch (e) {
Â  Â  Â  showError('Initialization Error: ' + e.message + '. Ensure your Apps Script Code.gs is correct and deployed.');
Â  Â  }
Â  Â Â 
Â  Â  // Set up global listeners
Â  Â  document.getElementById('scheduleClose').addEventListener('click', hideScheduleModal);
Â  Â  document.getElementById('scheduleModalBack').addEventListener('click', function(e) {
Â  Â  Â  if (e.target === this) {
Â  Â  Â  Â  hideScheduleModal();
Â  Â  Â  }
Â  Â  });
Â  }
Â Â 
Â  function populate(res) {
Â  Â  const weeks = res.weeks;
Â  Â  const days = res.days;
Â  Â  const people = res.people;
Â  Â Â 
Â  Â  const selects = [
Â  Â  Â  Â  { el: document.getElementById('weekSelect'), data: weeks },
Â  Â  Â  Â  { el: document.getElementById('weekSelect2'), data: weeks },
Â  Â  Â  Â  { el: document.getElementById('daySelect'), data: days },
Â  Â  Â  Â  { el: document.getElementById('daySelect2'), data: days },
Â  Â  ];

Â  Â  selects.forEach(({ el, data }) => {
Â  Â  Â  Â  el.innerHTML = '';
Â  Â  Â  Â  data.forEach(item => el.appendChild(new Option(item, item)));
Â  Â  });
Â  Â Â 
Â  Â  const whoSelect = document.getElementById('whoSelect');
Â  Â  whoSelect.innerHTML='';
Â  Â  people.forEach(p => whoSelect.appendChild(new Option(p,p)));
Â  Â Â 
Â  Â  // Set defaults (ensures the UI is ready for the first request)
Â  Â  if(weeks.length) { document.getElementById('weekSelect').value = weeks[0]; document.getElementById('weekSelect2').value = weeks[0]; }
Â  Â  if(days.length) { document.getElementById('daySelect').value = days[0]; document.getElementById('daySelect2').value = days[0]; }
Â  Â  document.getElementById('periodSelect').value = '1';Â 
Â  }

Â  // --- FEATURE FUNCTIONS ---

Â  async function loadRandomTag() {
Â  Â  try {
Â  Â  Â  const ph = await callApi('getRandomPhrase');
Â  Â  Â  const el = document.getElementById('randomTag');
Â  Â  Â  if (!ph) { el.style.display='none'; return; }
Â  Â  Â  el.textContent = ph;
Â  Â  Â  el.style.display='block';
Â  Â  } catch(e) {
Â  Â  Â  console.error("Failed to load tag:", e);
Â  Â  Â  document.getElementById('randomTag').style.display='none';
Â  Â  }
Â  }
Â  document.getElementById('refreshTag').addEventListener('click', loadRandomTag);

Â  document.getElementById('toggleExtra').addEventListener('click', function(){
Â  Â  const extra = document.getElementById('extraPanel');
Â  Â  extra.classList.toggle('open');
Â  Â  this.textContent = extra.classList.contains('open') ? 'Hide' : 'Show';
Â  });

Â  document.getElementById('checkBtn').addEventListener('click', async function(){
Â  Â  const week = document.getElementById('weekSelect').value;
Â  Â  const day = document.getElementById('daySelect').value;
Â  Â  const period = parseInt(document.getElementById('periodSelect').value,10);
Â  Â  showLoading(true, 'checkBtn', "Checkingâ€¦");
Â  Â  try {
Â  Â  Â  Â  const res = await callApi('getAvailability', [week, day, period]);
Â  Â  Â  Â  renderAvailability(res);
Â  Â  } catch (e) {
Â  Â  Â  Â  showError(e.message);
Â  Â  } finally {
Â  Â  Â  Â  showLoading(false, 'checkBtn', "Check who's free");
Â  Â  }
Â  });

Â  document.getElementById('lessonBtn').addEventListener('click', async function(){
Â  Â  const week = document.getElementById('weekSelect').value;
Â  Â  const day = document.getElementById('daySelect').value;
Â  Â  const period = parseInt(document.getElementById('periodSelect').value,10);
Â  Â  showLoading(true, 'lessonBtn', "Checkingâ€¦");
Â  Â  try {
Â  Â  Â  Â  const groups = await callApi('getWhoHasLessonNow', [week, day, period]);
Â  Â  Â  Â  renderWhoHasLesson(groups);
Â  Â  } catch (e) {
Â  Â  Â  Â  showError(e.message);
Â  Â  } finally {
Â  Â  Â  Â  showLoading(false, 'lessonBtn', "Who has a lesson");
Â  Â  }
Â  });

Â  // Add Phrase function
Â  document.getElementById('addPhraseBtn').addEventListener('click', function(){
Â  Â  const txt = document.getElementById('phraseInput').value.trim();
Â  Â  if (!txt) return showConfirm('Type a phrase first', null, 'OK');Â 
Â  Â  showConfirm(`Are you sure you want to add: "${txt}"?`, async () => {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  const r = await callApi('addPhrase', [txt]);
Â  Â  Â  Â  Â  Â  if (r && r.success) {
Â  Â  Â  Â  Â  Â  Â  Â  showConfirm('Added! Give the tag a refresh.', null, 'OK');
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('phraseInput').value = '';
Â  Â  Â  Â  Â  Â  Â  Â  loadRandomTag();Â 
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  showConfirm('Failed to add phrase', null, 'OK');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  showConfirm('API Error: ' + e.message, null, 'OK');
Â  Â  Â  Â  }
Â  Â  }, 'Yes, add', 'Cancel');
Â  });

Â  // What do I have today
Â  document.getElementById('whatBtn').addEventListener('click', async function(){
Â  Â  const who = document.getElementById('whoSelect').value;
Â  Â  const week = document.getElementById('weekSelect2').value;
Â  Â  const day = document.getElementById('daySelect2').value;
Â  Â Â 
Â  Â  const content = document.getElementById('modalScheduleContent');
Â  Â  const title = document.getElementById('scheduleTitle');
Â  Â Â 
Â  Â  content.innerHTML = '<div style="text-align:center;padding:10px;">Loadingâ€¦</div>';
Â  Â  title.textContent = `${who}'s Schedule for ${day}`;
Â  Â  showScheduleModal();Â 
Â  Â Â 
Â  Â  try {
Â  Â  Â  Â  const arr = await callApi('getDaySchedule', [who, week, day]);
Â  Â  Â  Â  content.innerHTML = '';
Â  Â  Â  Â  if (!arr || arr.length === 0) {
Â  Â  Â  Â  Â  Â  content.innerHTML = `<div class="muted" style="text-align:center;">No schedule found for ${who} on ${day}.</div>`;
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â  arr.forEach((s,idx) => {
Â  Â  Â  Â  Â  Â  const row = document.createElement('div'); row.className='scheduleRow';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const pnum = document.createElement('div'); pnum.className='scheduleCell pnum'; pnum.textContent = 'P' + (idx+1);
Â  Â  Â  Â  Â  Â  const subj = document.createElement('div'); subj.className='scheduleCell subj'; subj.textContent = s || '(free)';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  row.appendChild(pnum);Â 
Â  Â  Â  Â  Â  Â  row.appendChild(subj);Â 
Â  Â  Â  Â  Â  Â  content.appendChild(row);
Â  Â  Â  Â  });
Â  Â  } catch (e) {Â 
Â  Â  Â  content.innerHTML = `<div class="muted" style="color:#b00020; text-align:center;">Error: ${e.message}</div>`;Â 
Â  Â  }
Â  });


Â  // --- UI UTILITIES (Modals and Rendering) ---

Â  function renderAvailability(data) {
Â  Â  const area = document.getElementById('resultArea');
Â  Â  area.innerHTML = '';
Â  Â  if (!data) { area.innerHTML = '<div class="muted">No data</div>'; return; }
Â  Â  if (data.free && data.free.length) {
Â  Â  Â  const h = document.createElement('div'); h.style.marginBottom='8px'; h.textContent = 'Free right now:';
Â  Â  Â  area.appendChild(h);
Â  Â  Â  data.free.forEach(p => {
Â  Â  Â  Â  const row = document.createElement('div'); row.className='person';
Â  Â  Â  Â  row.innerHTML = `<div class="swatch" style="background:${p.color}"></div><div><strong>${p.name}</strong></div>`;
Â  Â  Â  Â  area.appendChild(row);
Â  Â  Â  });
Â  Â  } else {
Â  Â  Â  const p = document.createElement('div'); p.className='muted'; p.textContent = 'No one free right now.';
Â  Â  Â  area.appendChild(p);
Â  Â  }
Â  }

Â  function renderWhoHasLesson(groups) {
Â  Â  const area = document.getElementById('resultArea');
Â  Â  area.innerHTML = '';
Â  Â  if (!groups || groups.length === 0) { area.innerHTML = '<div class="muted">No one is in a lesson right now.</div>'; return; }
Â  Â  groups.forEach(g => {
Â  Â  Â  const block = document.createElement('div'); block.style.marginBottom='10px';
Â  Â  Â  block.innerHTML = `<div style="margin-bottom:6px"><strong>${g.subject}</strong></div>`;
Â  Â  Â  g.people.forEach(p => {
Â  Â  Â  Â  const row = document.createElement('div'); row.className='person';
Â  Â  Â  Â  row.innerHTML = `<div class="swatch" style="background:${p.color}"></div><div>${p.name}</div>`;
Â  Â  Â  Â  block.appendChild(row);
Â  Â  Â  });
Â  Â  Â  area.appendChild(block);
Â  Â  });
Â  }

Â  function showError(msg) {
Â  Â  const area = document.getElementById('resultArea');
Â  Â  area.innerHTML = `<div style="color:#b00020">${msg}</div>`;
Â  }

Â  function showLoading(is, buttonId, defaultText) {
Â  Â  const btn = document.getElementById(buttonId);
Â  Â  if (!btn) return;
Â  Â  if (is) {
Â  Â  Â  Â  btn.textContent = "Checkingâ€¦";
Â  Â  Â  Â  btn.disabled = true;
Â  Â  } else {
Â  Â  Â  Â  btn.textContent = defaultText;
Â  Â  Â  Â  btn.disabled = false;
Â  Â  }
Â  }

Â  function showScheduleModal() {
Â  Â  document.getElementById('scheduleModalBack').style.display = 'flex';
Â  Â  document.body.style.overflow = 'hidden';Â 
Â  }
Â Â 
Â  function hideScheduleModal() {
Â  Â  document.getElementById('scheduleModalBack').style.display = 'none';
Â  Â  document.body.style.overflow = 'auto';
Â  }

Â  // Custom Modal replacement for alert() and confirm()
Â  function showConfirm(text, onYes, yesText = 'Yes', noText = 'Cancel') {
Â  Â  const root = document.getElementById('confirmModal');
Â  Â  const isAlert = !onYes;Â 
Â  Â Â 
Â  Â  let buttonsHtml = '';
Â  Â  if (isAlert) {
Â  Â  Â  Â  buttonsHtml = `<button id="cNo" class="small" style="background:#111;color:#fff; flex:none;">${yesText}</button>`;
Â  Â  } else {
Â  Â  Â  Â  buttonsHtml = `<button id="cNo" class="small" style="flex:none;">${noText}</button><button id="cYes" class="small" style="background:#111;color:#fff;flex:none;">${yesText}</button>`;
Â  Â  }
Â  Â Â 
Â  Â  root.innerHTML = `<div class="modalBack"><div class="modal"><div><strong>${isAlert ? 'Notification' : 'Confirm'}</strong></div><div class="tiny" style="margin-top:8px">${text}</div><div style="display:flex; justify-content:flex-end; gap:8px; margin-top:12px">${buttonsHtml}</div></div></div>`;
Â  Â  root.style.display = 'block';
Â  Â Â 
Â  Â  const close = () => { root.style.display='none'; root.innerHTML=''; };
Â  Â Â 
Â  Â  document.getElementById('cNo').onclick = close;
Â  Â Â 
Â  Â  if (!isAlert) {
Â  Â  Â  document.getElementById('cYes').onclick = () => { close(); onYes(); };
Â  Â  }
Â  }


Â  window.onload = init;
</script>
</body>
</html>
